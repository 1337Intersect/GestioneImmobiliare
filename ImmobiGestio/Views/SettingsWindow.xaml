<Window x:Class="ImmobiGestio.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:ImmobiGestio.Converters"
        Title="Impostazioni - ImmobiGestio" 
        Height="700" Width="900"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource BackgroundBrush}"
        Icon="{x:Null}">

    <Window.Resources>
        <!-- Converters locali -->
        <converters:FileSizeConverter x:Key="FileSizeConverter"/>
        <converters:TimeIntervalConverter x:Key="TimeIntervalConverter"/>

        <!-- Stili per i controlli minimal -->
        <Style x:Key="MinimalTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                        Margin="{TemplateBinding Padding}"
                                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MinimalComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="3"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0" 
                                                Margin="{TemplateBinding Padding}"
                                                VerticalAlignment="Center"
                                                Content="{TemplateBinding SelectionBoxItem}"/>
                                <Path Grid.Column="1" 
                                      Data="M 0 0 L 4 4 L 8 0 Z" 
                                      Fill="{DynamicResource TextSecondary}"
                                      Margin="0,0,8,0"
                                      VerticalAlignment="Center"/>
                            </Grid>
                            <Popup x:Name="PART_Popup" 
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True">
                                <Border Background="{DynamicResource SurfaceBrush}"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="3">
                                    <ScrollViewer MaxHeight="200">
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MinimalButton" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Stile per i tab buttons -->
        <Style x:Key="TabButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="0">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource HoverBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Stile per tab button attivo -->
        <Style x:Key="TabButtonActiveStyle" TargetType="Button" BasedOn="{StaticResource TabButtonStyle}">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>

        <!-- Stile per le sezioni -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Stile per le label -->
        <Style x:Key="SettingsLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Stile per i controlli -->
        <Style x:Key="SettingsTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MinimalTextBox}">
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Height" Value="32"/>
        </Style>

        <Style x:Key="SettingsComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource MinimalComboBox}">
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Height" Value="32"/>
        </Style>

        <Style x:Key="SettingsCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Stile per i gruppi -->
        <Style x:Key="SettingsGroupStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Main Content -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="1"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Sidebar Navigation -->
            <Border Grid.Column="0" Background="{DynamicResource SurfaceBrush}">
                <StackPanel>
                    <Button Content="Generale" 
                            Style="{StaticResource TabButtonActiveStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Generale"/>
                    <Button Content="Percorsi" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Percorsi"/>
                    <Button Content="File" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="File"/>
                    <Button Content="Backup" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Backup"/>
                    <Button Content="Email" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Email"/>
                    <Button Content="Outlook" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Outlook"/>
                    <Button Content="Logging" 
                            Style="{StaticResource TabButtonStyle}"
                            Command="{Binding SelectTabCommand}"
                            CommandParameter="Logging"/>
                </StackPanel>
            </Border>

            <!-- Separator -->
            <Border Grid.Column="1" Background="{DynamicResource BorderBrush}"/>

            <!-- Content Area -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto" Padding="20">
                <StackPanel>
                    <!-- Sezione Generale -->
                    <StackPanel x:Name="GeneraleTab">
                        <TextBlock Text="Impostazioni Generali" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Applicazione" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Nome Applicazione:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.ApplicationName}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Versione:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.ApplicationVersion}" Style="{StaticResource SettingsTextBoxStyle}" IsReadOnly="True"/>

                                <TextBlock Text="Intervallo Salvataggio Automatico (secondi):" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.AutoSaveInterval, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Intervallo Aggiornamento Status (secondi):" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.StatusRefreshInterval, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione Percorsi -->
                    <StackPanel x:Name="PercorsiTab" Visibility="Collapsed">
                        <TextBlock Text="Percorsi e Cartelle" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Cartelle di Sistema" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Cartella Documenti:" Style="{StaticResource SettingsLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Settings.DocumentsPath}" Style="{StaticResource SettingsTextBoxStyle}" Grid.Column="0"/>
                                    <Button Content="Sfoglia" Style="{StaticResource MinimalButton}" Grid.Column="1" Margin="8,0,0,12"
                                            Command="{Binding BrowseDocumentsPathCommand}"/>
                                </Grid>

                                <TextBlock Text="Cartella Foto:" Style="{StaticResource SettingsLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Settings.PhotosPath}" Style="{StaticResource SettingsTextBoxStyle}" Grid.Column="0"/>
                                    <Button Content="Sfoglia" Style="{StaticResource MinimalButton}" Grid.Column="1" Margin="8,0,0,12"
                                            Command="{Binding BrowsePhotosPathCommand}"/>
                                </Grid>

                                <TextBlock Text="Cartella Backup:" Style="{StaticResource SettingsLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Settings.BackupPath}" Style="{StaticResource SettingsTextBoxStyle}" Grid.Column="0"/>
                                    <Button Content="Sfoglia" Style="{StaticResource MinimalButton}" Grid.Column="1" Margin="8,0,0,12"
                                            Command="{Binding BrowseBackupPathCommand}"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione File -->
                    <StackPanel x:Name="FileTab" Visibility="Collapsed">
                        <TextBlock Text="Gestione File" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Limiti Dimensioni" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Dimensione Massima Documenti:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.MaxDocumentSize, Converter={StaticResource FileSizeConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Dimensione Massima Foto:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.MaxPhotoSize, Converter={StaticResource FileSizeConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Formati Supportati" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Formati Documenti:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.SupportedDocumentFormats}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Formati Immagini:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.SupportedImageFormats}" Style="{StaticResource SettingsTextBoxStyle}"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione Backup -->
                    <StackPanel x:Name="BackupTab" Visibility="Collapsed">
                        <TextBlock Text="Backup e Sicurezza" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Backup Automatico" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <CheckBox Content="Abilita Backup Automatico" 
                                         IsChecked="{Binding Settings.AutoBackupEnabled}" 
                                         Style="{StaticResource SettingsCheckBoxStyle}"/>

                                <TextBlock Text="Giorni tra Backup:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.AutoBackupDays, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Numero Massimo File Backup:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.MaxBackupFiles, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione Email -->
                    <StackPanel x:Name="EmailTab" Visibility="Collapsed">
                        <TextBlock Text="Configurazione Email" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Server SMTP" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Server SMTP:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.SMTPServer}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Porta:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.SMTPPort, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Username:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.SMTPUsername}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Password:" Style="{StaticResource SettingsLabelStyle}"/>
                                <PasswordBox x:Name="PasswordBox" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <TextBlock Text="Email Mittente:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.EmailFrom}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <Button Content="Test Connessione" Style="{StaticResource MinimalButton}"
                                        Command="{Binding TestEmailConnectionCommand}" Margin="0,8,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione Outlook -->
                    <StackPanel x:Name="OutlookTab" Visibility="Collapsed">
                        <TextBlock Text="Integrazione Outlook" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Sincronizzazione" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <CheckBox Content="Abilita Integrazione Outlook" 
                                         IsChecked="{Binding Settings.OutlookIntegrationEnabled}" 
                                         Style="{StaticResource SettingsCheckBoxStyle}"/>

                                <TextBlock Text="Intervallo Sincronizzazione (secondi):" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.OutlookSyncInterval, Converter={StaticResource TimeIntervalConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>

                                <Button Content="Test Connessione Outlook" Style="{StaticResource MinimalButton}"
                                        Command="{Binding TestOutlookConnectionCommand}" Margin="0,8,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <!-- Sezione Logging -->
                    <StackPanel x:Name="LoggingTab" Visibility="Collapsed">
                        <TextBlock Text="Sistema di Logging" Style="{StaticResource SectionHeaderStyle}"/>

                        <GroupBox Header="Configurazione Log" Style="{StaticResource SettingsGroupStyle}">
                            <StackPanel>
                                <TextBlock Text="Livello Log:" Style="{StaticResource SettingsLabelStyle}"/>
                                <ComboBox SelectedValue="{Binding Settings.LogLevel}" Style="{StaticResource SettingsComboBoxStyle}">
                                    <ComboBoxItem Content="Debug"/>
                                    <ComboBoxItem Content="Info"/>
                                    <ComboBoxItem Content="Warning"/>
                                    <ComboBoxItem Content="Error"/>
                                </ComboBox>

                                <CheckBox Content="Salva Log su File" 
                                         IsChecked="{Binding Settings.LogToFile}" 
                                         Style="{StaticResource SettingsCheckBoxStyle}"/>

                                <TextBlock Text="Percorso File Log:" Style="{StaticResource SettingsLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Settings.LogFilePath}" Style="{StaticResource SettingsTextBoxStyle}" Grid.Column="0"/>
                                    <Button Content="Sfoglia" Style="{StaticResource MinimalButton}" Grid.Column="1" Margin="8,0,0,12"
                                            Command="{Binding BrowseLogFilePathCommand}"/>
                                </Grid>

                                <TextBlock Text="Numero Massimo File Log:" Style="{StaticResource SettingsLabelStyle}"/>
                                <TextBox Text="{Binding Settings.MaxLogFiles, Converter={StaticResource NumericConverter}}" Style="{StaticResource SettingsTextBoxStyle}"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Footer Buttons -->
        <Border Grid.Row="1" Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0" Padding="20">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Reset Default" Style="{StaticResource MinimalButton}" 
                        Background="{DynamicResource TextMuted}" Margin="0,0,12,0"
                        Command="{Binding ResetToDefaultCommand}"/>
                <Button Content="Esporta Impostazioni" Style="{StaticResource MinimalButton}" 
                        Background="{DynamicResource TextSecondary}" Margin="0,0,12,0"
                        Command="{Binding ExportSettingsCommand}"/>
                <Button Content="Annulla" Style="{StaticResource MinimalButton}" 
                        Background="{DynamicResource TextSecondary}" Margin="0,0,12,0"
                        Command="{Binding CancelCommand}"/>
                <Button Content="Salva" Style="{StaticResource MinimalButton}"
                        Command="{Binding SaveCommand}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>